@import "tailwindcss";

/* ═══════════════════════════════════════════════════════════════
   LIGHT MODE (default)
   Warm stone palette with olive accents.
   ═══════════════════════════════════════════════════════════════ */

:root {
  /* Surfaces */
  --bg: #e8e5df;
  --bg-card: #ffffff;
  --bg-elevated: #f5f3ef;
  --border: #d4d0c8;
  --border-light: #c2beb5;

  /* Text */
  --text-primary: #1c1917;
  --text-secondary: #44403c;
  --text-tertiary: #78716c;

  /* Olive accent */
  --accent: #5c6e3c;
  --accent-light: #edf2e4;
  --olive: #4d5e30;
  --olive-50: #f3f5ee;
  --olive-100: #dce4cc;
  --olive-200: #b8c99a;

  /* Status colors */
  --green: #15803d;
  --amber: #b45309;
  --red: #dc2626;
  --blue: #1d4ed8;

  /* Semantic surfaces — subtle tints for dark/light adaptability */
  --surface-subtle: rgba(0, 0, 0, 0.02);
  --surface-tint: rgba(0, 0, 0, 0.03);
  --surface-overlay: rgba(0, 0, 0, 0.06);
  --surface-dots: rgba(0, 0, 0, 0.08);
  --surface-url: rgba(0, 0, 0, 0.04);

  /* Grade pill backgrounds */
  --grade-green-bg: #f0fdf4;
  --grade-green-border: rgba(187, 247, 208, 0.6);
  --grade-blue-bg: #eff6ff;
  --grade-blue-border: rgba(191, 219, 254, 0.6);
  --grade-amber-bg: #fffbeb;
  --grade-amber-border: rgba(253, 230, 138, 0.6);
  --grade-red-bg: #fef2f2;
  --grade-red-border: rgba(254, 202, 202, 0.6);

  /* Error / warning banners */
  --error-bg: #fef2f2;
  --error-border: #fecaca;
  --warning-bg: rgba(255, 251, 235, 0.5);
  --warning-border: rgba(253, 230, 138, 0.3);
}

/* ═══════════════════════════════════════════════════════════════
   DARK MODE
   Warm charcoal palette — NOT a cold blue-dark.
   Colours are boosted slightly for contrast on dark surfaces.
   ═══════════════════════════════════════════════════════════════ */

.dark {
  /* Surfaces */
  --bg: #1a1917;
  --bg-card: #252321;
  --bg-elevated: #2c2a27;
  --border: #3d3935;
  --border-light: #4a453f;

  /* Text — flipped from light mode backgrounds for contrast.
     Primary on dark bg → ~12:1 ratio.
     Secondary → ~7:1.
     Tertiary → ~4.6:1 (passes AA). */
  --text-primary: #e8e5df;
  --text-secondary: #b8b3ab;
  --text-tertiary: #8a847d;

  /* Olive accent — brighter for contrast on dark.
     #7a9b4a on #1a1917 → ~5.3:1 (passes AA). */
  --accent: #7a9b4a;
  --accent-light: #2a3020;
  --olive: #7a9b4a;
  --olive-50: #252920;
  --olive-100: #3a4230;
  --olive-200: #5a6e42;

  /* Status — brighter variants for dark surfaces */
  --green: #22c55e;
  --amber: #f59e0b;
  --red: #ef4444;
  --blue: #3b82f6;

  /* Semantic surfaces — white tints instead of black */
  --surface-subtle: rgba(255, 255, 255, 0.025);
  --surface-tint: rgba(255, 255, 255, 0.04);
  --surface-overlay: rgba(255, 255, 255, 0.07);
  --surface-dots: rgba(255, 255, 255, 0.1);
  --surface-url: rgba(255, 255, 255, 0.06);

  /* Grade pills — transparent tinted backgrounds */
  --grade-green-bg: rgba(34, 197, 94, 0.1);
  --grade-green-border: rgba(34, 197, 94, 0.25);
  --grade-blue-bg: rgba(59, 130, 246, 0.1);
  --grade-blue-border: rgba(59, 130, 246, 0.25);
  --grade-amber-bg: rgba(245, 158, 11, 0.1);
  --grade-amber-border: rgba(245, 158, 11, 0.25);
  --grade-red-bg: rgba(239, 68, 68, 0.1);
  --grade-red-border: rgba(239, 68, 68, 0.25);

  /* Error / warning banners */
  --error-bg: rgba(239, 68, 68, 0.1);
  --error-border: rgba(239, 68, 68, 0.25);
  --warning-bg: rgba(245, 158, 11, 0.08);
  --warning-border: rgba(245, 158, 11, 0.2);
}

/* ═══════════════════════════════════════════════════════════════
   TAILWIND THEME TOKENS
   ═══════════════════════════════════════════════════════════════ */

@theme inline {
  --color-bg: var(--bg);
  --color-bg-card: var(--bg-card);
  --color-bg-elevated: var(--bg-elevated);
  --color-border: var(--border);
  --color-border-light: var(--border-light);
  --color-ds-primary: var(--text-primary);
  --color-ds-secondary: var(--text-secondary);
  --color-ds-tertiary: var(--text-tertiary);
  --color-ds-accent: var(--accent);
  --color-ds-olive: var(--olive);
  --color-ds-olive-50: var(--olive-50);
  --color-ds-olive-100: var(--olive-100);
  --color-ds-olive-200: var(--olive-200);
  --color-ds-green: var(--green);
  --color-ds-amber: var(--amber);
  --color-ds-red: var(--red);
  --color-ds-blue: var(--blue);
  --color-surface-subtle: var(--surface-subtle);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
  --font-serif: var(--font-instrument-serif);
  --animate-fade-up: fadeUp 0.4s ease-out both;
  --animate-results-shell: resultsShell 0.55s cubic-bezier(0.22, 1, 0.36, 1) both;
  --animate-results-content: resultsContent 0.45s cubic-bezier(0.22, 1, 0.36, 1) 0.15s both;
  --animate-ace-pulse: acePulse 2s ease-in-out 1s infinite;
  --animate-modal-backdrop: modalBackdrop 0.3s ease-out both;
  --animate-modal-expand: modalExpand 0.45s cubic-bezier(0.22, 1, 0.36, 1) both;
  --animate-modal-content-in: modalContentIn 0.35s cubic-bezier(0.22, 1, 0.36, 1) 0.2s both;
  --animate-modal-backdrop-out: modalBackdropOut 0.25s ease-in 0.05s both;
  --animate-modal-collapse: modalCollapse 0.3s cubic-bezier(0.4, 0, 1, 1) both;
  --animate-modal-content-out: modalContentOut 0.15s ease-in both;
  --animate-minimize: minimize 0.4s cubic-bezier(0.4, 0, 0.2, 1) both;
  --animate-restore-shell: restoreShell 0.4s cubic-bezier(0.22, 1, 0.36, 1) both;
  --animate-restore-content: restoreContent 0.35s cubic-bezier(0.22, 1, 0.36, 1) 0.12s both;
  --animate-dock-in: dockIn 0.3s cubic-bezier(0.22, 1, 0.36, 1) 0.2s both;
  --animate-dock-out: dockOut 0.18s cubic-bezier(0.4, 0, 1, 1) both;
  --animate-quote-out: quoteOut 0.18s cubic-bezier(0.4, 0, 1, 1) both;
  --animate-quote-line: quoteLine 0.45s cubic-bezier(0.22, 1, 0.36, 1) 0.25s both;
  --animate-quote-attr: quoteAttr 0.45s cubic-bezier(0.22, 1, 0.36, 1) 0.4s both;
}

/* ═══════════════════════════════════════════════════════════════
   KEYFRAMES
   ═══════════════════════════════════════════════════════════════ */

@keyframes fadeUp {
  from { opacity: 0; transform: translateY(12px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Lighter variant for compact stacked items (progress steps) —
   less travel prevents overlapping motion in tight vertical lists */
@keyframes fadeUpSmall {
  from { opacity: 0; transform: translateY(6px); }
  to   { opacity: 1; transform: translateY(0); }
}

/* Results card entrance — shell rises up from further below, slower deceleration */
@keyframes resultsShell {
  from { opacity: 0; transform: translateY(28px); }
  to   { opacity: 1; transform: translateY(0); }
}

/* Results card content — pure opacity fade, slightly delayed after the shell */
@keyframes resultsContent {
  from { opacity: 0; }
  to   { opacity: 1; }
}

@keyframes blink {
  0%, 45% { opacity: 1; }
  50%, 100% { opacity: 0; }
}

@keyframes growBar {
  from { transform: scaleX(0); }
  to { transform: scaleX(1); }
}

@keyframes pulse-dot {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.5; transform: scale(0.75); }
}

@keyframes slideDown {
  from { opacity: 0; transform: translateY(-8px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes drift {
  0%   { transform: translate(0, 0) scale(1); }
  33%  { transform: translate(30px, -25px) scale(1.05); }
  66%  { transform: translate(-25px, 30px) scale(0.95); }
  100% { transform: translate(0, 0) scale(1); }
}

@keyframes drift2 {
  0%   { transform: translate(0, 0) scale(1); }
  33%  { transform: translate(-20px, 25px) scale(0.97); }
  66%  { transform: translate(25px, -15px) scale(1.03); }
  100% { transform: translate(0, 0) scale(1); }
}

/* ── Ambient particles ───────────────────────────────────────── */

/* Stars (dark mode) — gentle opacity pulse.
   --twinkle-max is set per-particle for varied brightness. */
@keyframes twinkle {
  0%, 100% { opacity: 0; }
  50%      { opacity: var(--twinkle-max, 0.5); }
}

/* Shooting star (dark mode) — dot head streaks upper-right → lower-left.
   rotate(315deg) orients it, translateX pulls it across the sky.
   All visual styling is inline; only the keyframe lives here. */
@keyframes shooting-star {
  0%   { transform: rotate(315deg) translateX(0); opacity: 1; }
  70%  { opacity: 1; }
  100% { transform: rotate(315deg) translateX(-600px); opacity: 0; }
}

/* Dust motes (light mode) — drift slowly while fading in/out.
   --mote-max, --mote-dx, --mote-dy set per-particle. */
@keyframes float-mote {
  0%   { opacity: 0; transform: translate(0, 0); }
  25%  { opacity: var(--mote-max, 0.2); }
  75%  { opacity: var(--mote-max, 0.2); }
  100% { opacity: 0; transform: translate(var(--mote-dx, 20px), var(--mote-dy, -30px)); }
}

/* Ghost preview exit — lifts up + fades out before progress steps appear */
@keyframes ghostExit {
  from { opacity: 1; transform: translateY(0) scale(1); }
  to   { opacity: 0; transform: translateY(-12px) scale(0.98); }
}

/* Indeterminate loading bar — slides back and forth within track */
@keyframes loading-slide {
  0%   { left: -30%; }
  50%  { left: 65%; }
  100% { left: -30%; }
}

/* Ace grade — subtle pulse/glow on the letter */
@keyframes acePulse {
  0%, 100% { filter: brightness(1) drop-shadow(0 0 0px transparent); }
  50%      { filter: brightness(1.15) drop-shadow(0 0 8px currentColor); }
}

/* Error shake — horizontal wobble like macOS wrong-password */
@keyframes error-shake {
  0%, 100% { transform: translateX(0); }
  10%, 50%, 90% { transform: translateX(-4px); }
  30%, 70% { transform: translateX(4px); }
}

/* Fullscreen modal — backdrop fades in */
@keyframes modalBackdrop {
  from { opacity: 0; }
  to   { opacity: 1; }
}

/* Fullscreen modal — card rises from below into position */
@keyframes modalExpand {
  from { opacity: 0; transform: translateY(48px); }
  to   { opacity: 1; transform: translateY(0); }
}

/* Fullscreen modal — backdrop fades out */
@keyframes modalBackdropOut {
  from { opacity: 1; }
  to   { opacity: 0; }
}

/* Fullscreen modal — card sinks back down on exit */
@keyframes modalCollapse {
  from { opacity: 1; transform: translateY(0); }
  to   { opacity: 0; transform: translateY(48px); }
}

/* Fullscreen modal — inner content fades in after shell arrives */
@keyframes modalContentIn {
  from { opacity: 0; }
  to   { opacity: 1; }
}

/* Fullscreen modal — inner content fades out before shell leaves */
@keyframes modalContentOut {
  from { opacity: 1; }
  to   { opacity: 0; }
}

/* ── Minimize / restore easter egg ─────────────────────────── */

/* Card sinks down, tilts slightly in perspective, fades out */
@keyframes minimize {
  0%   { opacity: 1; transform: perspective(800px) translateY(0) rotateX(0deg) scale(1); }
  100% { opacity: 0; transform: perspective(800px) translateY(64px) rotateX(2.5deg) scale(0.97); }
}

/* Card shell fades in from below */
@keyframes restoreShell {
  0%   { opacity: 0; transform: translateY(28px); }
  100% { opacity: 1; transform: translateY(0); }
}

/* Card inner content fades in slightly after the shell
   (starts invisible, prevents the content "blink") */
@keyframes restoreContent {
  0%   { opacity: 0; }
  100% { opacity: 1; }
}

/* Dock chip rises into place */
@keyframes dockIn {
  0%   { opacity: 0; transform: translateX(-50%) translateY(12px); }
  100% { opacity: 1; transform: translateX(-50%) translateY(0); }
}

/* Dock chip drops away */
@keyframes dockOut {
  0%   { opacity: 1; transform: translateX(-50%) translateY(0); }
  100% { opacity: 0; transform: translateX(-50%) translateY(10px); }
}

/* Quote fades out on restore */
@keyframes quoteOut {
  0%   { opacity: 1; }
  100% { opacity: 0; }
}

/* Decorative line grows in from center */
@keyframes quoteLine {
  0%   { transform: scaleX(0); opacity: 0; }
  100% { transform: scaleX(1); opacity: 1; }
}

/* Attribution fades in after quote */
@keyframes quoteAttr {
  0%   { opacity: 0; transform: translateY(4px); }
  100% { opacity: 1; transform: translateY(0); }
}

/* ── Page entrance orchestration ──────────────────────────── */

/* Gradient orbs — fade in from transparent to their own opacity.
   Only the `from` state is defined; the `to` value is inherited
   from the element's Tailwind opacity class (e.g. opacity-[0.18]).
   Uses a separate property (opacity) from the drift animation
   (transform), so both run simultaneously without conflict. */
@keyframes orbReveal {
  from { opacity: 0; }
}

/* Generic fade-in — used for layout-level elements like ThemeToggle
   that live outside the GSAP-orchestrated container. */
@keyframes fadeIn {
  from { opacity: 0; }
  to   { opacity: 1; }
}

/* SSR-safe initial state for page entrance.
   Elements with [data-enter] inside a [data-page-enter] container
   start invisible from the very first paint (no FOUC). GSAP then
   animates them in. Once complete, [data-page-entered] is added
   to the container, which disables this rule so elements stay
   visible if they remount later (e.g. ghost preview after reset). */
[data-page-enter]:not([data-page-entered]) [data-enter] {
  opacity: 0;
}

/* ═══════════════════════════════════════════════════════════════
   BASE STYLES
   ═══════════════════════════════════════════════════════════════ */

/* Kill browser default purple focus outline on all buttons globally.
   Keyboard focus gets a clean olive ring via :focus-visible instead.
   Inputs keep :focus (not :focus-visible) because the user needs to
   see which text field is active while typing. */
button:focus {
  outline: none;
}
button:focus-visible {
  outline: 2px solid var(--olive);
  outline-offset: 2px;
  border-radius: inherit;
}

/* Smooth transition for theme changes — applied to bg and text.
   Only targets properties that change, avoids janky animation on
   everything else (transforms, opacity, etc). */
html {
  transition: background-color 0.4s ease, color 0.4s ease;
}

body {
  background: var(--bg);
  color: var(--text-primary);
  font-family: var(--font-geist-sans), system-ui, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  overflow-x: hidden;
  transition: background-color 0.4s ease, color 0.4s ease;
}

/* Scrollbar */
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: #b5b1a8; border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: #9e9a91; }
.dark ::-webkit-scrollbar-thumb { background: #4a453f; }
.dark ::-webkit-scrollbar-thumb:hover { background: #5a544d; }
